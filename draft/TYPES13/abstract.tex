\documentclass[a4paper]{easychair} % A4 is needed for the abstract book

%\documentclass[a4paper, debug]{easychair} 
% can be used to better see overfull boxes

\usepackage{enumerate}

\bibliographystyle{plain}

%\newtheorem{thm}{Theorem}   % no such environments are predefined

\title{Type-Based Termination of\\ Term-Indexed Types}
\titlerunning{Type-Based Termination of Term-Indexed Types}
\author{
Ki Yung Ahn\inst{1}
\and
Tim Sheard\inst{1}
 \and
Marcelo Fiore\inst{2}
}
\institute{
  Portland State University~\thanks{supported by NSF grant 0910500.}
%%, \\ Portland, OR, USA
\and
  University of Cambridge
%%, \\ Cambridge, UK
}
\authorrunning{Author1 and Author2}

\newcommand{\cf}[0]{{cf.}}
\newcommand{\eg}[0]{{e.g.}}
\newcommand{\ie}[0]{{i.e.}}
\newcommand{\aka}[0]{{a.k.a.}}

\newcommand{\F}[0]{{\ensuremath{\mathsf{\uppercase{F}}}}}
\newcommand{\Fw}[0]{{\ensuremath{\mathsf{\uppercase{F}}_{\!\omega}}}}
\newcommand{\Fixw}[0]{{\ensuremath{\mathsf{\uppercase{F}\lowercase{ix}}_{\!\omega}}}}

\begin{document}
\maketitle

%\begin{abstract}
%\end{abstract}
% abstracts of abstracts are not compulsory

The context of our work is the Nax programming language project.
We are developing a unified programming and reasoning system,
called Nax, with the following design goals:\vspace*{-1ex}
\begin{enumerate}[(1)]
 \item Nax supports the major constructs of modern functional programming languages,
 such as parametric polymorphism, recursive datatypes, and type inference,
 \vspace*{-1.2ex}
 \item Nax can specify fine-grained program properties as types and
 witness proofs of such properties by writing a program (The Curry--Howard correspondence),
 \vspace*{-1.2ex}
 \item Nax is based on a minimal foundational calculus
 that is expressive enough to embed all language constructs in (1)
 and is also logically consistent to avoid paradoxical proofs in (2),\vspace*{-1.2ex}
 \item Nax has a simple implementation infrastructure that keeps the trusted base small.
\end{enumerate}
\vspace*{-.5ex}
Our approach towards these goals is to 
design an appropriate foundational calculus
that extends \Fw \cite{Girard72} or \Fixw \cite{AbeMat04} to support
\emph{Mendler-style recursion schemes} \cite{Mendler87} with \emph{term-indexed datatypes}.
Mendler-style recursion schemes support (1) since they are based
on parametric polymorphism and well-defined over wide range of datatypes.
They also support (4) since their termination is type-based --
no other termination checking infrastructure is necessary.
Term-indexed datatypes support (2), for instance,
statically specifying the size of a list using a natural number index in the list type.

In this abstract, we outline a paper
that will discuss the advantages of adopting the Mendler style,
and then introduce a new Mendler-style recursion scheme whose
termination rely on the invariants specified by term-indices.
\vspace*{-1ex}
\paragraph{Advantages of adopting the Mendler style\!\!\!}
include allowing arbitrary definition of recursive datatypes, while still 
ensuring well-behaved use by providing rich set of principled eliminators.
Certain concepts, such as Higher-Order Abstract Syntax (HOAS), are
most succinctly defined as mixed-variant datatypes. However, most existing
reasoning systems (\eg, Coq, Agda), based on the Curry--Howard correspondence,
unfortunately, restrict definition of mixed-variant recursive datatypes.
As a result, one is forced to devise clever tricks \cite{PHOAS}
to encode concepts like HOAS within the restrictive datatypes allowed in such systems.

We believe it is worthwhile to allow definition of all recursive datatypes
(\eg, non-strictly positive, mixed-variant, nested)
usually available in functional languages, but outlawed in reasoning systems.
For instance, we can define a HOAS for the untyped lambda-calculus in Haskell.
\begin{verbatim}
    data Exp = Abs (Exp -> Exp) | App Exp Exp
\end{verbatim}
Even if we assume all functions embedded in \texttt{Abs} are non-recursive,
evaluating HOAS expressions may still cause problems when reasoning logically,
since the untyped lambda calculus has diverging terms. However, there are
many well-behaved computations on \texttt{Exp}. For instance, examining whether
an HOAS expression is \texttt{Abs} or \texttt{App}, and, converting an HOAS expression
to first-order syntax are examples of terminating computation on \texttt{Exp}.
Ahn and Sheard \cite{AhnShe11} formalized a Mendler-style recursion scheme
that captures these well-behaved computations.

If the datatype \texttt{Exp} used term-indexes to assert invariants of well
formed expressions, we could rely on these invariants to write even more expressive
programs, such as a well-typed evaluator. Discussion of this idea
will constitute the second part of the paper.
\vspace*{-1ex}
\paragraph{Term-indices that govern termination behavior over datatypes\!\!\!}
motivate a new Mendler-style recursion scheme.
Consider yet another HOAS datatype below for the Simply-Typed Lambda-Calculus (STLC)
defined in Nax-like syntax,\footnote{curly braces emphasize
  term-indices used in types (\texttt{Exp\{t1\}}),
  and types used in kinds (\texttt{\{Ty\}\;->\;*}).}
where HOAS expressions (\texttt{Expr}) are
statically indexed by the terms that represent STLC-types (\texttt{Ty}).
\begin{verbatim}
    data Ty : * where    Iota : Ty
                         Arr  : Ty -> Ty -> Ty
\end{verbatim}\vspace*{-2ex}
\begin{verbatim}
    data Exp : {Ty} -> * where   Abs : (Exp{t1} -> Exp{t2}) -> Exp{Arr t1 t2}
                                 App : Exp{Arr t1 t2} -> Exp{t1} -> Exp{t2}
\end{verbatim}
Unlike the HOAS datatype for untyped lambda calculus, evaluating
these term-indexed HOAS expressions will always terminate,
since the STLC is strongly normalizing.
The intuitive principle behind the termination behavior of \texttt{Exp\,:\,\{Ty\}\,->\,*}
comes from the paradigmatic use of term-indices at negative recursive occurrences.  
In the type of \texttt{Abs}, the term index \texttt{t1}
at negative recursive occurrence is ``smaller'' than the index
(\texttt{Arr t1 t2}) of the result type. In the type of \texttt{App},
the two term-indices (\texttt{Arr t1 t2}) and \texttt{t1} at positive recursive
occurrences are larger than and unrelated to the index \texttt{t2} of the result type.
Thus, we conjecture that our new Mendler-style recursion scheme, namely \textsf{MPrIx},
which enables us to write an evaluator for  \texttt{Exp\,:\,\{Ty\}\,->\,*}, 
is well-defined when every index at a negative recursive occurrence is
smaller than the index of the result type.
In the paper, we will \vspace*{-.5ex}
\begin{itemize}
 \item Formulate the type signature and the reduction rule of \textsf{MPrIx},
 \vspace*{-1ex}
 \item Clearly specify what ``smaller'' means, and
 \vspace*{-1ex}
 \item Prove that \textsf{MPrIx} terminates whenever it is well defined.
 \vspace*{-1ex}
\end{itemize}
\vspace{-1ex}
\paragraph{The impact\!\!} of our work is not limited to
systems like Nax that adopt Mendler-style or type-based termination.
We hope to inspire other existing Curry--Howard based reasoning systems
to support datatypes like \texttt{Exp\,:\,\{Ty\}\,->\,*}.
For instance, perhaps the positivity checker in Agda may be extended to accept
not only positive datatypes but also certain term-indexed negative datatypes
whose negative occurrences are guarded by our ``smaller'' condition.
\vspace{-1ex}
% create the bibliography
\bibliography{main}   % refers to main.bib
\end{document}
